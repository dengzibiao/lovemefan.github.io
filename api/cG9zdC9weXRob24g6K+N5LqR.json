{"title":"Python小实践   微博爬虫之数据分析","date":"2018-06-20T03:39:00.000Z","author":"lovemefan","thumbnail":"images/wordcloud.png","excerpt":"","slug":"python 词云","comments":true,"tags":["学习笔记","Python","编程语言"],"updated":"2018-09-05T01:53:45.889Z","content":"<h1 id=\"python-词云\"><a href=\"#python-词云\" class=\"headerlink\" title=\"python 词云\"></a>python 词云</h1><h2 id=\"1-前期准备\"><a href=\"#1-前期准备\" class=\"headerlink\" title=\"1. 前期准备\"></a>1. 前期准备</h2><h3 id=\"1-1-下载相关库\"><a href=\"#1-1-下载相关库\" class=\"headerlink\" title=\"1.1 下载相关库\"></a>1.1 下载相关库</h3><ul>\n<li>jieba (用于分词)</li>\n<li>matplotlib</li>\n<li>wordcloud<br><code>注意事项:</code><br>如果相关库安装失败,请到<a href=\"https://www.lfd.uci.edu/~gohlke/pythonlibs/\" target=\"_blank\" rel=\"external\">https://www.lfd.uci.edu/~gohlke/pythonlibs/</a>下载相应包手动安装,注意python版本号与操作系统位数,如下图,例如python3.6,64位操作系统则选择<code>cp36-win_amd64.whl</code>文件下载<br><img src=\"http://oskhhyaq3.bkt.clouddn.com/img/180905/6Ch55mcee6.png?imageslim\" alt=\"mark\"><h3 id=\"使用命令行安装相关库\"><a href=\"#使用命令行安装相关库\" class=\"headerlink\" title=\"使用命令行安装相关库\"></a>使用命令行安装相关库</h3><figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">pip install 包名或本地包路径</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<h2 id=\"2-wordcloud\"><a href=\"#2-wordcloud\" class=\"headerlink\" title=\"2. wordcloud\"></a>2. wordcloud</h2><blockquote>\n<p>wordcloud基于Python的词云生成类库,很好用,而且功能强大<br><a href=\"https://github.com/amueller/word_cloud\" target=\"_blank\" rel=\"external\">Github</a><br><a href=\"https://amueller.github.io/word_cloud\" target=\"_blank\" rel=\"external\">官方文档</a><br><a href=\"https://blog.csdn.net/fly910905/article/details/77763086\" target=\"_blank\" rel=\"external\">参考博文</a></p>\n</blockquote>\n<h2 id=\"3-小试牛刀\"><a href=\"#3-小试牛刀\" class=\"headerlink\" title=\"3. 小试牛刀\"></a>3. 小试牛刀</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># coding: utf-8</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> json</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> jieba.analyse</div><div class=\"line\"><span class=\"keyword\">import</span> matplotlib <span class=\"keyword\">as</span> mpl</div><div class=\"line\"><span class=\"keyword\">from</span> scipy.misc <span class=\"keyword\">import</span> imread</div><div class=\"line\"><span class=\"keyword\">from</span> wordcloud <span class=\"keyword\">import</span> WordCloud</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># mpl.use('TkAgg')</span></div><div class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">keywords</span><span class=\"params\">(mblogs)</span>:</span></div><div class=\"line\">    text = []</div><div class=\"line\">    <span class=\"keyword\">for</span> blog <span class=\"keyword\">in</span> mblogs:</div><div class=\"line\">        keyword = jieba.analyse.extract_tags(blog[<span class=\"string\">'text'</span>])</div><div class=\"line\">        text.extend(keyword)</div><div class=\"line\">    <span class=\"keyword\">return</span> text</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">gen_img</span><span class=\"params\">(texts, img_file)</span>:</span></div><div class=\"line\">    data = <span class=\"string\">' '</span>.join(text <span class=\"keyword\">for</span> text <span class=\"keyword\">in</span> texts)</div><div class=\"line\">    image_coloring = imread(img_file)</div><div class=\"line\">    wc = WordCloud(</div><div class=\"line\">        background_color=<span class=\"string\">'white'</span>,</div><div class=\"line\">        mask=image_coloring,</div><div class=\"line\">        max_font_size=<span class=\"number\">500</span>,  <span class=\"comment\"># 设置字体最大值</span></div><div class=\"line\">        font_path=<span class=\"string\">'Fonts/HYC6GFM.TTF'</span>,</div><div class=\"line\">        random_state = <span class=\"number\">30</span>  <span class=\"comment\"># 设置有多少种随机生成状态，即有多少种配色方案</span></div><div class=\"line\">    )</div><div class=\"line\">    wc.generate(data)</div><div class=\"line\">    <span class=\"comment\"># plt.figure()</span></div><div class=\"line\">    <span class=\"comment\"># plt.imshow(wc, interpolation=\"bilinear\")</span></div><div class=\"line\">    <span class=\"comment\"># plt.axis(\"off\")</span></div><div class=\"line\">    <span class=\"comment\"># plt.show()</span></div><div class=\"line\"></div><div class=\"line\">    wc.to_file(img_file.split(<span class=\"string\">'.'</span>)[<span class=\"number\">0</span>] + <span class=\"string\">'_wc.png'</span>)</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</div><div class=\"line\">    keyword = <span class=\"string\">'shida'</span></div><div class=\"line\">    mblogs = json.loads(open(<span class=\"string\">'result_&#123;&#125;.json'</span>.format(keyword), <span class=\"string\">'r'</span>, encoding=<span class=\"string\">'utf-8'</span>).read())</div><div class=\"line\">    print(<span class=\"string\">'微博总数：'</span>, len(mblogs))</div><div class=\"line\"></div><div class=\"line\">    words = []</div><div class=\"line\">    <span class=\"keyword\">for</span> blog <span class=\"keyword\">in</span> mblogs:</div><div class=\"line\">        words.extend(jieba.analyse.extract_tags(blog[<span class=\"string\">'text'</span>]))</div><div class=\"line\"></div><div class=\"line\">    print(<span class=\"string\">\"总词数：\"</span>, len(words))</div><div class=\"line\">    print(words)</div><div class=\"line\">    gen_img(words, <span class=\"string\">'love.jpg'</span>)</div></pre></td></tr></table></figure>\n<p>效果图</p>\n<p><img src=\"http://oskhhyaq3.bkt.clouddn.com/img/180905/EhLH9dKA6g.png?imageslim\" alt=\"mark\"><br><img src=\"http://oskhhyaq3.bkt.clouddn.com/img/180905/02i70841eb.png?imageslim\" alt=\"mark\"></p>\n","prev":{"title":"后端架构师技术图谱 --来自github","slug":"《后端架构师技术图谱》"},"next":{"title":"Python小实践   下载漫画","slug":"爬取前准备"},"link":"/post/python 词云/index.html  2018/06/20","toc":[{"title":"python 词云","id":"python-词云","index":"1","children":[{"title":"1. 前期准备","id":"1-前期准备","index":"1.1","children":[{"title":"1.1 下载相关库","id":"1-1-下载相关库","index":"1.1.1"},{"title":"使用命令行安装相关库","id":"使用命令行安装相关库","index":"1.1.2"}]},{"title":"2. wordcloud","id":"2-wordcloud","index":"1.2"},{"title":"3. 小试牛刀","id":"3-小试牛刀","index":"1.3"}]}]}