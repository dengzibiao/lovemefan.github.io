{"title":"Java学习笔记 (一)   基于Robot类的一些自动测试类的一些应用","date":"2017-10-17T13:03:00.000Z","excerpt":"<p><strong> Java学习笔记 (一)   基于Robot类的一些自动测试类的一些应用：</strong> <excerpt in=\"\" index=\"\" |=\"\" 首页摘要=\"\"></excerpt></p>","slug":"Java Robot类的一些应用","tags":["学习笔记","编程语言","Java"],"updated":"2017-10-17T13:06:08.604Z","content":"<p><strong> Java学习笔记 (一)   基于Robot类的一些自动测试类的一些应用：</strong> <excerpt in=\"\" index=\"\" |=\"\" 首页摘要=\"\"></excerpt></p>\n<a id=\"more\"></a>\n<p><the rest=\"\" of=\"\" contents=\"\" |=\"\" 余下全文=\"\"></the></p>\n<h1 id=\"Java-Robot类的一些应用\"><a href=\"#Java-Robot类的一些应用\" class=\"headerlink\" title=\"Java Robot类的一些应用\"></a>Java Robot类的一些应用</h1><h2 id=\"Robot简介\"><a href=\"#Robot简介\" class=\"headerlink\" title=\"Robot简介\"></a>Robot简介</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;Robot类是JAVA程序实现自动测试，自动演示功能，或者是其它的一些鼠标和键盘控制的应用。出于这样的目的，自从JDK1.3开始，它就为我们提供了一个用来产生本机输入事件的机器人类－－java.awt.Robot.<br>&nbsp;&nbsp;&nbsp;&nbsp;此类本来是通过操作鼠标键盘来完成软件的自动测试使用的,我们可以利用Robot类来实现一些我们想要达到的结果</p>\n<h2 id=\"Robot-API\"><a href=\"#Robot-API\" class=\"headerlink\" title=\"Robot API\"></a>Robot API</h2><p><a href=\"https://docs.oracle.com/javase/7/docs/api/java/awt/Robot.html\" target=\"_blank\" rel=\"external\">官方英文API</a><br><code>Robot类其中的方法:</code><br><img src=\"http://oskhhyaq3.bkt.clouddn.com/blog/171017/17j0LJJLEB.png?imageslim\" alt=\"methods\"></p>\n<p>通过查看API,Robot类提供了<code>截屏</code> <code>获取屏幕某一点的像素的颜色``键盘按下和释放事件``鼠标点击和释放事件``鼠标移动事件``鼠标滑轮事件</code>.</p>\n<h2 id=\"Demo\"><a href=\"#Demo\" class=\"headerlink\" title=\"Demo\"></a>Demo</h2><p>这个demo是来实现模拟键盘的一个例子.实现一个信息轰炸功能.<br>点击运行后,将光标移到输入区域,程序运行五秒之后会在光标出不断输出字符.<br>其中还要使用到java.awt.event.KeyEvent类中的键值<br>代码如下:<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> java.awt.AWTException;</div><div class=\"line\"><span class=\"keyword\">import</span> java.awt.Robot;</div><div class=\"line\"><span class=\"keyword\">import</span> java.awt.event.KeyEvent;</div><div class=\"line\"><span class=\"keyword\">import</span> java.util.HashMap;</div><div class=\"line\"><span class=\"keyword\">import</span> java.util.Map;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">sendMessage</span> </span>&#123;</div><div class=\"line\">\t</div><div class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">int</span> delayTime;</div><div class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">int</span> range;</div><div class=\"line\">\tRobot robot ;</div><div class=\"line\">\tMap map;</div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">sendMessage</span><span class=\"params\">(<span class=\"keyword\">int</span> delayTime,<span class=\"keyword\">int</span> range)</span></span></div><div class=\"line\">\t&#123;</div><div class=\"line\">\t\t<span class=\"keyword\">this</span>.delayTime = delayTime;</div><div class=\"line\">\t\t<span class=\"keyword\">this</span>.range = range;</div><div class=\"line\">\t&#125;</div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">send</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">\t\t<span class=\"comment\">//使用map 将控制键盘的常量存起来，好方便取用。</span></div><div class=\"line\">\t\tmap = <span class=\"keyword\">new</span> HashMap();</div><div class=\"line\">\t\tmap.put(<span class=\"number\">0</span>, <span class=\"number\">0x30</span>);<span class=\"comment\">//键盘的0</span></div><div class=\"line\">\t\tmap.put(<span class=\"number\">1</span>, <span class=\"number\">0x31</span>);<span class=\"comment\">//键盘的1</span></div><div class=\"line\">\t\tmap.put(<span class=\"number\">2</span>, <span class=\"number\">0x32</span>);</div><div class=\"line\">\t\tmap.put(<span class=\"number\">3</span>, <span class=\"number\">0x33</span>);</div><div class=\"line\">\t\tmap.put(<span class=\"number\">4</span>, <span class=\"number\">0x34</span>);</div><div class=\"line\">\t\tmap.put(<span class=\"number\">5</span>, <span class=\"number\">0x35</span>);</div><div class=\"line\">\t\tmap.put(<span class=\"number\">6</span>, <span class=\"number\">0x36</span>);</div><div class=\"line\">\t\tmap.put(<span class=\"number\">7</span>, <span class=\"number\">0x37</span>);</div><div class=\"line\">\t\tmap.put(<span class=\"number\">8</span>, <span class=\"number\">0x38</span>);</div><div class=\"line\">\t\tmap.put(<span class=\"number\">9</span>, <span class=\"number\">0x39</span>);</div><div class=\"line\">\t\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t\t\trobot = <span class=\"keyword\">new</span> Robot();</div><div class=\"line\">\t\t\t\trobot.delay(<span class=\"number\">5000</span>);<span class=\"comment\">//延迟5秒供你打开编辑器</span></div><div class=\"line\">\t\t\t\teditContent2();</div><div class=\"line\">\t\t\t\t</div><div class=\"line\">\t\t&#125; <span class=\"keyword\">catch</span> (AWTException e) &#123;</div><div class=\"line\">\t\t<span class=\"comment\">// TODO Auto-generated catch block</span></div><div class=\"line\">\t\te.printStackTrace();</div><div class=\"line\">\t\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t&#125;</div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</div><div class=\"line\">\t\t<span class=\"comment\">//每隔几毫秒,以及数值的范围</span></div><div class=\"line\">\t\tsendMessage demo = <span class=\"keyword\">new</span> sendMessage(<span class=\"number\">1000</span>,<span class=\"number\">200</span>);</div><div class=\"line\">\t\tdemo.send();</div><div class=\"line\">\t&#125;</div><div class=\"line\">\t<span class=\"comment\">/*********************************************</span></div><div class=\"line\">\t *editContent1实验的功能输出从0到Range的一个方法</div><div class=\"line\">   \t ********************************************/</div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">editContent1</span><span class=\"params\">()</span></span></div><div class=\"line\">\t&#123;</div><div class=\"line\">\t\t<span class=\"comment\">//让机器从0数到Range</span></div><div class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt;= range; i++) &#123;</div><div class=\"line\">\t\t\trobot.delay(<span class=\"keyword\">this</span>.delayTime);</div><div class=\"line\">\t\t\t<span class=\"comment\">// 个位数的处理</span></div><div class=\"line\">\t\t\t<span class=\"keyword\">if</span> (i &lt;= <span class=\"number\">9</span>) &#123;</div><div class=\"line\">\t\t\t\trobot.keyPress((<span class=\"keyword\">int</span>) map.get(i));</div><div class=\"line\">\t\t\t\trobot.keyRelease((<span class=\"keyword\">int</span>) map.get(i));</div><div class=\"line\">\t\t\t\trobot.keyPress(KeyEvent.VK_ENTER);</div><div class=\"line\">\t\t\t\trobot.keyRelease(KeyEvent.VK_ENTER);</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t\t<span class=\"comment\">// 两位数的处理</span></div><div class=\"line\">\t\t\t<span class=\"keyword\">if</span> (i &gt; <span class=\"number\">9</span> &amp;&amp; i &lt;= <span class=\"number\">99</span>) &#123;</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> a = i / <span class=\"number\">10</span>;<span class=\"comment\">// 十位</span></div><div class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> b = i % <span class=\"number\">10</span>;<span class=\"comment\">// 个位</span></div><div class=\"line\">\t\t\t\trobot.keyPress((<span class=\"keyword\">int</span>) map.get(a));</div><div class=\"line\">\t\t\t\trobot.keyRelease((<span class=\"keyword\">int</span>) map.get(a));</div><div class=\"line\">\t\t\t\trobot.keyPress((<span class=\"keyword\">int</span>) map.get(b));</div><div class=\"line\">\t\t\t\trobot.keyRelease((<span class=\"keyword\">int</span>) map.get(b));</div><div class=\"line\">\t\t\t\trobot.keyPress(KeyEvent.VK_ENTER);</div><div class=\"line\">\t\t\t\trobot.keyRelease(KeyEvent.VK_ENTER);</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t\t<span class=\"comment\">// 三位数的处理</span></div><div class=\"line\">\t\t\t<span class=\"keyword\">if</span> (i &gt; <span class=\"number\">99</span> &amp;&amp; i &lt;= <span class=\"number\">999</span>) &#123;</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> a = i / <span class=\"number\">100</span>;<span class=\"comment\">// 百位</span></div><div class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> b = (i % <span class=\"number\">100</span>) / <span class=\"number\">10</span>;<span class=\"comment\">// 十位</span></div><div class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> c = i % <span class=\"number\">10</span>;<span class=\"comment\">// 个位</span></div><div class=\"line\">\t\t\t\trobot.keyPress((<span class=\"keyword\">int</span>) map.get(a));</div><div class=\"line\">\t\t\t\trobot.keyRelease((<span class=\"keyword\">int</span>) map.get(a));</div><div class=\"line\">\t\t\t\trobot.keyPress((<span class=\"keyword\">int</span>) map.get(b));</div><div class=\"line\">\t\t\t\trobot.keyRelease((<span class=\"keyword\">int</span>) map.get(b));</div><div class=\"line\">\t\t\t\trobot.keyPress((<span class=\"keyword\">int</span>) map.get(c));</div><div class=\"line\">\t\t\t\trobot.keyRelease((<span class=\"keyword\">int</span>) map.get(c));</div><div class=\"line\">\t\t\t\trobot.keyPress(KeyEvent.VK_ENTER);</div><div class=\"line\">\t\t\t\trobot.keyRelease(KeyEvent.VK_ENTER);</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125;</div><div class=\"line\">\t<span class=\"comment\">/************************************************************************</span></div><div class=\"line\">\t *editContent2为模拟键盘输入,在英文输入法状态下输出为拼音字母,中文输入法状态下为中文</div><div class=\"line\">   \t ************************************************************************/</div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">editContent2</span><span class=\"params\">()</span></span></div><div class=\"line\">\t&#123;</div><div class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; range; i++) &#123;</div><div class=\"line\">\t\t\trobot.delay(<span class=\"keyword\">this</span>.delayTime/<span class=\"number\">2</span>);</div><div class=\"line\">\t\t\trobot.keyPress(KeyEvent.VK_C);</div><div class=\"line\">\t\t\trobot.keyRelease(KeyEvent.VK_C);</div><div class=\"line\">\t\t\trobot.keyPress(KeyEvent.VK_N);</div><div class=\"line\">\t\t\trobot.keyRelease(KeyEvent.VK_N);</div><div class=\"line\">\t\t\trobot.keyPress(KeyEvent.VK_M);</div><div class=\"line\">\t\t\trobot.keyRelease(KeyEvent.VK_M);</div><div class=\"line\">\t\t\trobot.keyPress(KeyEvent.VK_SPACE);</div><div class=\"line\">\t\t\trobot.delay(<span class=\"keyword\">this</span>.delayTime/<span class=\"number\">2</span>); <span class=\"comment\">//注意,不过不加delay,在按下之母后立即继续按下后续操作会让输入法来不及相应,所以要延迟一小段时间</span></div><div class=\"line\">\t\t\trobot.keyPress(KeyEvent.VK_ENTER);</div><div class=\"line\">\t\t\trobot.keyRelease(KeyEvent.VK_ENTER);</div><div class=\"line\">\t\t\t</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t\t</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>上面有两个方法分别是<code>editContent1</code>和<code>editContent2</code>,前者仅仅是从键盘输入一些数字,后者是在打开中文输入法的情况下依次输入中文的拼音,模拟人为打字.</p>\n<p>运行结果如下:<br><img src=\"http://oskhhyaq3.bkt.clouddn.com/blog/171017/afljFb21L3.png?imageslim\" alt=\"mark\"></p>\n","prev":{"title":"Excel 宏命令处理(一)","slug":"Excel 宏命令处理"},"next":{"title":"Python学习笔记 (四)  安装scrapy框架","slug":"scrapy框架"},"link":"/post/Java Robot类的一些应用/index.html  2017/10/17","toc":[{"title":"Java Robot类的一些应用","id":"Java-Robot类的一些应用","index":"1","children":[{"title":"Robot简介","id":"Robot简介","index":"1.1"},{"title":"Robot API","id":"Robot-API","index":"1.2"},{"title":"Demo","id":"Demo","index":"1.3"}]}]}